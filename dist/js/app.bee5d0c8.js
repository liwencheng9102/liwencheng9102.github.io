(function(e){function t(t){for(var r,o,c=t[0],i=t[1],u=t[2],l=0,p=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);f&&f(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a={app:0},s=[];function c(e){return i.p+"js/"+({}[e]||e)+"."+{"chunk-074c77df":"f7d93e34","chunk-1bf97147":"5f775867","chunk-54cbd691":"02a26ceb","chunk-56ea52e8":"37d8dd22","chunk-5e6181bc":"a8728827","chunk-62afe30c":"646eee7d"}[e]+".js"}function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n={"chunk-074c77df":1,"chunk-1bf97147":1,"chunk-54cbd691":1,"chunk-56ea52e8":1,"chunk-5e6181bc":1,"chunk-62afe30c":1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise(function(t,n){for(var r="css/"+({}[e]||e)+"."+{"chunk-074c77df":"33adf993","chunk-1bf97147":"338b3f14","chunk-54cbd691":"6cfcf81d","chunk-56ea52e8":"1da08cab","chunk-5e6181bc":"c819686a","chunk-62afe30c":"9cb1c0b0"}[e]+".css",a=i.p+r,s=document.getElementsByTagName("link"),c=0;c<s.length;c++){var u=s[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return t()}var p=document.getElementsByTagName("style");for(c=0;c<p.length;c++){u=p[c],l=u.getAttribute("data-href");if(l===r||l===a)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var r=t&&t.target&&t.target.src||a,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete o[e],f.parentNode.removeChild(f),n(s)},f.href=a;var d=document.getElementsByTagName("head")[0];d.appendChild(f)}).then(function(){o[e]=0}));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise(function(t,n){r=a[e]=[t,n]});t.push(r[2]=s);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=c(e);var p=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(f);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",p.name="ChunkLoadError",p.type=r,p.request=o,n[1](p)}a[e]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var f=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),o=n.n(r);o.a},"0418":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-wrapper"},[n("div",{staticClass:"fixedWrapper"},[n("div",{staticClass:"header"},[e._m(0),n("p",[e._v(e._s(e.titalName))]),n("a-popover",{staticClass:"popover",attrs:{placement:"bottomRight"}},[n("template",{attrs:{trigger:"focus"},slot:"content"},[n("p",{attrs:{type:"primary"},on:{click:e.showModal}},[n("a-icon",{attrs:{type:"user-add"}}),e._v("  添加好友\n          ")],1),n("a-modal",{staticClass:"a-modal",attrs:{title:"添加好友",okText:"添加",cancelText:"取消",zIndex:e.zIndex,closable:e.closable},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("a-input",{ref:"userNameInput",attrs:{placeholder:"请输入添加好友的用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}},[n("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"}),n("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:e.emitEmpty},slot:"suffix"})],1)],1),n("p",{on:{click:e.showCreateModal}},[n("a-icon",{attrs:{type:"message"}}),e._v("  创建群聊\n          ")],1),n("a-modal",{staticClass:"a-modal",attrs:{title:"创建群聊",okText:"创建",cancelText:"取消",zIndex:e.zIndex,closable:e.closable},on:{ok:e.handleOk_creategroup},model:{value:e.creategroup_visible,callback:function(t){e.creategroup_visible=t},expression:"creategroup_visible"}},[n("a-input",{attrs:{placeholder:"请输入您想要创建的群组名"},model:{value:e.creatgroup,callback:function(t){e.creatgroup=t},expression:"creatgroup"}},[n("a-icon",{attrs:{slot:"prefix",type:"message"},slot:"prefix"})],1)],1),n("p",{on:{click:e.showAddModal}},[n("a-icon",{attrs:{type:"usergroup-add"}}),e._v("  添加群聊\n          ")],1),n("a-modal",{staticClass:"a-modal",attrs:{title:"添加群聊",okText:"添加",cancelText:"取消",zIndex:e.zIndex,closable:e.closable},on:{ok:e.handleOk_addgroup},model:{value:e.addgroup_visible,callback:function(t){e.addgroup_visible=t},expression:"addgroup_visible"}},[n("a-input",{attrs:{placeholder:"请输入添加群组的群组id"},model:{value:e.addgroup,callback:function(t){e.addgroup=t},expression:"addgroup"}},[n("a-icon",{attrs:{slot:"prefix",type:"message"},slot:"prefix"})],1)],1)],1),n("span",[n("a-icon",{attrs:{type:"plus"}})],1)],2)],1),n("div",{staticClass:"search"},[n("a-input-search",{staticClass:"inputSearch",attrs:{placeholder:"搜索"},on:{search:e.onSearch}})],1)])])},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"lineImg"},[r("img",{attrs:{src:n("1407"),alt:""}})])}],a=(n("8e6e"),n("ac6a"),n("456d"),n("380f"),n("f64c")),s=n("bd86"),c=n("2f62");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l={name:"Header",data:function(){return{headTitle:"消息",zIndex:9999,closable:!1,visible:!1,creategroup_visible:!1,addgroup_visible:!1,username:"",creatgroup:"",addgroup:""}},computed:u({},Object(c["e"])(["activeTab"]),{titalName:function(){return"messageTital"===this.activeTab?(this.headTitle="消息",this.headTitle):"contacts"===this.activeTab?(this.headTitle="通讯录",this.headTitle):"user"===this.activeTab?(this.headTitle="我",this.headTitle):void 0}}),methods:u({},Object(c["b"])(["addFriends","createGroupNew","joinGroup","agreeJoinGroup"]),{onSearch:function(e){console.log(e)},showModal:function(){this.visible=!0},showCreateModal:function(){this.creategroup_visible=!0},showAddModal:function(){this.addgroup_visible=!0},emitEmpty:function(){this.$refs.userNameInput.focus(),this.username=""},handleOk:function(){this.username.trim()&&(this.addFriends(this.username),this.visible=!1,a["a"].success("好友请求已发送！")),this.username=""},handleOk_creategroup:function(){this.creatgroup.trim()&&(this.createGroupNew(this.creatgroup),this.creategroup_visible=!1,a["a"].success("群组已成功创建！")),this.creatgroup=""},handleOk_addgroup:function(){var e=this;this.addgroup.trim()&&(this.joinGroup(this.addgroup).then(function(t){e.agreeJoinGroup(e.addgroup),a["a"].success("已成功加入群组！")},function(){a["a"].warning("您已经在这个群组里了！")}),this.addgroup_visible=!1),this.creatgroup=""}})},p=l,f=(n("28f0"),n("2877")),d=Object(f["a"])(p,r,o,!1,null,"06d71e28",null);t["a"]=d.exports},1282:function(e,t,n){e.exports=n.p+"img/timg.34b04191.jpg"},1407:function(e,t,n){e.exports=n.p+"img/QQ.ef9106f3.jpg"},"1a48":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="1a48"},"1cd8":function(e,t,n){"use strict";var r=n("58ea"),o=n.n(r);o.a},"28f0":function(e,t,n){"use strict";var r=n("50bb"),o=n.n(r);o.a},"3a59":function(e,t,n){},"3d39":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"navbar"},[n("div",{class:["tab",{active:"messageTital"===e.activeTab}],on:{click:e.switchRouterA}},[n("a-icon",{staticClass:"icon",attrs:{type:"message"}}),e._m(0)],1),n("div",{class:["tab",{active:"contacts"===e.activeTab}],on:{click:e.switchRouterB}},[n("a-badge",{attrs:{count:e.messages.length,dot:""}},[n("a-icon",{staticClass:"icon",attrs:{type:"contacts"}})],1),e._m(1)],1),n("div",{class:["tab",{active:"user"===e.activeTab}],on:{click:e.switchRouterC}},[n("a-icon",{staticClass:"icon",attrs:{type:"user"}}),e._m(2)],1)])},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabText"},[n("span",[e._v("消息")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabText"},[n("span",[e._v("通讯录")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabText"},[n("span",[e._v("我")])])}],a=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),s=n("2f62");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach(function(t){Object(a["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u={name:"Tabbar",data:function(){return{}},computed:i({},Object(s["e"])(["messages","activeTab"])),methods:i({},Object(s["d"])(["change_tab"]),{switchRouterA:function(){var e="messageTital";this.change_tab(e),this.$router.push({path:"/home/message"})},switchRouterB:function(){var e="contacts";this.change_tab(e),this.$router.push({path:"/home/contacts"})},switchRouterC:function(){var e="user";this.change_tab(e),this.$router.push({path:"/home/user"})}})},l=u,p=(n("6a3f"),n("2877")),f=Object(p["a"])(l,r,o,!1,null,"3c88da0c",null);t["a"]=f.exports},"50bb":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("a481"),n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],s=(n("034f"),n("2877")),c={},i=Object(s["a"])(c,o,a,!1,null,null,null),u=i.exports,l=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("router-view")],1)},f=[],d={name:"home"},g=d,m=Object(s["a"])(g,p,f,!1,null,null,null),h=m.exports,b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"about"},[r("img",{attrs:{alt:"logo",src:n("1282")}}),r("div",{staticClass:"group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"user-ipt",attrs:{type:"text",placeholder:"用户名"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),r("div",{staticClass:"group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"user-ipt",attrs:{type:"password",placeholder:"密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),r("div",{staticClass:"btn",class:{active:e.isActive},on:{click:e.login}},[r("span",[r("a-icon",{attrs:{type:"arrow-right"}})],1)]),r("div",{staticClass:"linkto"},[r("router-link",{staticClass:"routerlink",attrs:{to:"/register"}},[e._v("用户注册")]),e._v("|\n    "),r("span",[e._v("忘记密码")]),r("div",{staticClass:"bottom"},[e._v("文城出品 必属精品")])],1)])},v=[],y=(n("8e6e"),n("ac6a"),n("456d"),n("04f3"),n("ed3b")),O=n("bd86"),w=n("2f62");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach(function(t){Object(O["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j={name:"about",data:function(){return{username:"",password:""}},computed:M({isActive:function(){return!(!this.username||!this.password)}},Object(w["e"])(["loginStatus"])),methods:M({},Object(w["b"])(["receivedUser","loginGetToken"]),{login:function(){if(this.username&&this.password){var e={username:this.username,password:this.password};this.receivedUser(e),this.loginGetToken()}else y["a"].warning({title:"输入框不能为空"})}}),watch:{loginStatus:function(e,t){e!==t&&!0===e&&(console.log("登录状态发生变化,并且登录成功"),this.$router.replace("/home"))}},components:{}},k=j,S=(n("1cd8"),Object(s["a"])(k,b,v,!1,null,"32289cec",null)),x=S.exports,I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"chatList"},[r("Header"),r("div",{ref:"wrapper",staticClass:"scoll_wrapper"},[r("ul",[e._l(e.msgDataSource,function(t,o){return r("li",{key:o,on:{click:function(t){return e.toChatbox(o)}}},[r("img",{attrs:{src:n("1282"),alt:""}}),r("div",{staticClass:"content"},[r("h3",[e._v(e._s(o))]),r("span",[e._v(e._s(t[t.length-1].data))])]),r("div",{staticClass:"unread"},[r("a-badge",{attrs:{count:e.getnum(t)}})],1)])}),e._l(e.groupMsgData,function(t,o){return r("li",{key:o,on:{click:function(t){return e.toChatgroup(o)}}},[r("img",{attrs:{src:n("a0cf"),alt:""}}),r("div",{staticClass:"content"},[r("h3",[e._v("groupid:"+e._s(o))]),r("span",[e._v(e._s(t[t.length-1].data))])]),r("div",{staticClass:"unread"},[r("a-badge",{attrs:{count:e.getnum(t)}})],1)])})],2)]),r("Tabbar")],1)},D=[],C=(n("7f7f"),n("0418")),P=n("3d39"),T=n("1fba");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){Object(O["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var W={name:"messageView",data:function(){return{}},computed:G({},Object(w["e"])(["msgDataSource","groupMsgData"]),{getnum:function(){return function(e){var t=[];return e.forEach(function(e){e.badge&&1===e.badge&&t.push(e)}),t.length}}}),components:{Header:C["a"],Tabbar:P["a"]},methods:G({},Object(w["d"])(["updateUnread","updateGroupUnread"]),{},Object(w["b"])(["getGroupInfo"]),{toChatbox:function(e){this.updateUnread(e),this.$store.commit("receive_activeUser",e),this.$router.push({name:"chatbox",params:{username:e}})},toChatgroup:function(e){var t=this;this.updateGroupUnread(e),this.$store.commit("receive_activegroup",e),this.$router.push({name:"chatgroup",params:{groupid:e}}),this.getGroupInfo(e).then(function(e){t.$store.state.title=e.data[0].name},function(){})},initBetterScroll:function(){this.wrapperScroll?this.wrapperScroll.refresh():this.wrapperScroll=new T["a"](this.$refs.wrapper,{click:!0})}}),beforeMount:function(){var e=localStorage.getItem(this.$store.state.user.username);e&&(this.$store.state.msgDataSource=JSON.parse(e));var t=localStorage.getItem("groupMsg");t&&(this.$store.state.groupMsgData=JSON.parse(t))},mounted:function(){this.initBetterScroll()},beforeDestroy:function(){this.wrapperScroll.destroy(),this.wrapperScroll=null}},N=W,R=(n("c16a"),Object(s["a"])(N,I,D,!1,null,"03c6e5b2",null)),U=R.exports;r["a"].use(l["a"]);var $=new l["a"]({mode:"history",base:"/mobile/",scorllBehavior:function(){return{y:0}},routes:[{path:"/home",redirect:{name:"message"},name:"home",component:h,children:[{path:"/home/message",name:"message",component:U},{path:"/home/contacts",name:"contacts",component:function(){return n.e("chunk-54cbd691").then(n.bind(null,"c93c"))}},{path:"/home/user",name:"user",component:function(){return n.e("chunk-1bf97147").then(n.bind(null,"1511"))}},{path:"/home/chatbox/:username",name:"chatbox",component:function(){return n.e("chunk-5e6181bc").then(n.bind(null,"368a"))}},{path:"/home/chatgroup/:groupid",name:"chatgroup",component:function(){return n.e("chunk-56ea52e8").then(n.bind(null,"4b54"))}},{path:"/home/chatgroup/:groupid/groupdetail",name:"groupdetail",component:function(){return n.e("chunk-62afe30c").then(n.bind(null,"dc55"))}}]},{path:"/login",name:"login",component:x},{path:"/register",name:"register",component:function(){return n.e("chunk-074c77df").then(n.bind(null,"73cf"))}}]}),A=n("75fc"),L=function(e,t){var n=t.onOpened,r=t.handlePresence,o=t.receiveMsg,a=t.receiveGroupMsg;e.listen({onOpened:function(e){n(),console.log("当前项目已经与环信服务器连接成功")},onClosed:function(e){},onTextMessage:function(e){console.log("收到消息",e),"chat"==e.type?o(e):"groupchat"==e.type&&a(e)},onEmojiMessage:function(e){},onPictureMessage:function(e){},onCmdMessage:function(e){},onAudioMessage:function(e){},onLocationMessage:function(e){},onFileMessage:function(e){},onVideoMessage:function(t){var n=document.getElementById("privateVideo"),r={url:t.url,headers:{Accept:"audio/mp4"},onFileDownloadComplete:function(t){var r=WebIM.utils.parseDownloadResponse.call(e,t);n.src=r},onFileDownloadError:function(){console.log("File down load error.")}};WebIM.utils.download.call(e,r)},onPresence:function(e){r(e)},onRoster:function(e){},onInviteMessage:function(e){},onOnline:function(){},onOffline:function(){},onError:function(e){console.log(e)},onBlacklistUpdate:function(e){console.log(e)},onReceivedMessage:function(e){},onDeliveredMessage:function(e){},onReadMessage:function(e){},onCreateGroup:function(e){},onMutedMessage:function(e){}})};function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){Object(O["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}r["a"].use(w["a"]);var J=new w["a"].Store({state:{activeTab:"messageTital",WebIM:null,user:{username:"",password:"",token:""},loginStatus:!1,roster:[],messages:[],msgDataSource:{},activeUser:"",group:[],title:"",groupMsgData:{},activeGroup:""},getters:{msgList:function(e){var t=e.activeUser,n=e.msgDataSource;return t&&n[t]?n[t]:[]},groupMsgList:function(e){var t=e.activeGroup,n=e.groupMsgData;return t&&n[t]?n[t]:[]}},mutations:{change_tab:function(e,t){e.activeTab=t},receive_tokek:function(e,t){e.user=F({},e.user,{token:t})},receive_username:function(e,t){e.user=F({},e.user,{username:t})},receive_password:function(e,t){e.user=F({},e.user,{password:t})},change_login_status:function(e,t){e.loginStatus=t},RECEIVE_IM:function(e,t){e.WebIM=t},receive_roster:function(e,t){e.roster=t},receive_messages:function(e,t){e.messages.push(t)},dec_messages:function(e,t){e.messages=e.messages.filter(function(e){return e.from!==t})},addNewMsg:function(e,t){var n=t.from;e.msgDataSource[n]?e.msgDataSource[n]=[].concat(Object(A["a"])(e.msgDataSource[n]),[t]):e.msgDataSource=F({},e.msgDataSource,Object(O["a"])({},n,[t]));var r=e.user.username;localStorage.setItem(r,JSON.stringify(e.msgDataSource))},addGRoupMsg:function(e,t){var n=t.to;e.groupMsgData[n]?e.groupMsgData[n]=[].concat(Object(A["a"])(e.groupMsgData[n]),[t]):e.groupMsgData=F({},e.groupMsgData,Object(O["a"])({},n,[t]));var r="groupMsg";localStorage.setItem(r,JSON.stringify(e.groupMsgData))},receive_activeUser:function(e,t){e.activeUser=t},receive_activegroup:function(e,t){e.activeGroup=t},updateUnread:function(e,t){for(var n in e.msgDataSource)n==t&&e.msgDataSource[n].forEach(function(e){e.badge&&1==e.badge&&(e.badge=2)});var r=e.user.username;localStorage.setItem(r,JSON.stringify(e.msgDataSource))},updateGroupUnread:function(e,t){for(var n in e.groupMsgData)n==t&&e.groupMsgData[n].forEach(function(e){e.badge&&1==e.badge&&(e.badge=2)});var r="groupMsg";localStorage.setItem(r,JSON.stringify(e.groupMsgData))},receive_group:function(e,t){e.group=t}},actions:{getConnectionAndCreateEventListener:function(e,t){var n=e.commit,r=e.dispatch;n("RECEIVE_IM",t),L(t.conn,{onOpened:function(){n("change_login_status",!0)},handlePresence:function(e){"subscribe"===e.type&&n("receive_messages",e),"subscribed"===e.type&&r("getRoster")},receiveMsg:function(e){e=F({},e,{badge:1}),n("addNewMsg",e)},receiveGroupMsg:function(e){e=F({},e,{badge:1}),n("addGRoupMsg",e)}})},loginGetToken:function(e){var t=e.commit,n=e.state,r=n.user,o=r.username,a=r.password;if(o.trim()&&a.trim()){var s={apiUrl:n.WebIM.config.apiURL,user:o,pwd:a,appKey:n.WebIM.config.appkey,success:function(e){e=e.access_token,t("receive_tokek",e)},error:function(){}};n.WebIM.conn.open(s)}},receivedUser:function(e,t){var n=e.commit,r=t.username,o=t.password;n("receive_username",r),n("receive_password",o)},registerWebIM:function(e,t){var n=e.state,r=t.username,o=t.password,a=t.nickname;return new Promise(function(e,t){var s={username:r,password:o,nickname:a,appKey:n.WebIM.config.appkey,success:function(){e()},error:function(e){t(e)},apiUrl:n.WebIM.config.apiURL};n.WebIM.conn.registerUser(s)})},addFriends:function(e,t){var n=e.state;n.WebIM.conn.subscribe({to:t,message:"加个好友呗!"})},agreeFriends:function(e,t){var n=e.state,r=e.commit,o=e.dispatch;n.WebIM.conn.subscribed({to:t,message:"[resp:true]"}),o("getRoster"),r("dec_messages",t)},disagreeFriends:function(e,t){var n=e.state,r=e.commit;n.WebIM.conn.unsubscribed({to:t,message:"rejectAddFriend"}),r("dec_messages",t)},getRoster:function(e){var t=e.state,n=e.commit;t.WebIM.conn.getRoster({success:function(e){for(var t=[],r=0,o=e.length;r<o;r++){var a=e[r];"both"!==a.subscription&&"to"!==a.subscription||t.push(a)}n("receive_roster",t)}})},sendTextMeg:function(e,t){var n=e.state,r=e.commit,o=t.to,a=t.msg,s=n.WebIM.conn.getUniqueId(),c=new n.WebIM.message("txt",s);c.set({msg:a,to:o,roomType:!1,ext:{},success:function(e){console.log("send private text Success"),r("addNewMsg",{id:e,data:a,from:o,self:!0})},fail:function(e){console.log("Send private text error",e)}}),n.WebIM.conn.send(c.body)},getGroup:function(e){var t=e.state,n=e.commit,r={success:function(e){n("receive_group",e.data)},error:function(e){console.log(e)}};t.WebIM.conn.getGroup(r)},createGroupNew:function(e,t){var n=e.state,r={data:{groupname:t,desc:"info",members:[n.user.username],public:!0,approval:!1},success:function(e){console.log(e)}};n.WebIM.conn.createGroupNew(r)},getGroupInfo:function(e,t){var n=e.state;return new Promise(function(e,r){var o={groupId:t,success:function(t){e(t)},error:function(){r()}};n.WebIM.conn.getGroupInfo(o)})},quitGroup:function(e,t){e.state},listGroupMember:function(e,t){var n=e.state,r=1,o=1e3,a={pageNum:r,pageSize:o,groupId:t,success:function(e){console.log("群组成员: ",e.data),n.group=e.data},error:function(e){console.log(e)}};n.WebIM.conn.listGroupMember(a)},setAdmin:function(e,t){var n=e.state,r=t.gid,o=t.user,a={groupId:r,username:o,success:function(e){console.log("成功设为管理员 =>",e)},error:function(e){console.log(e)}};n.WebIM.conn.setAdmin(a)},inviteToGroup:function(e,t){var n=e.state,r=e.dispatch,o=t.user,a=t.gid,s={users:[o],groupId:a,success:function(){var e={gid:a,user:o};r("setAdmin",e)},error:function(e){console.log("invite error",e)}};n.WebIM.conn.inviteToGroup(s)},joinGroup:function(e,t){var n=e.state;return new Promise(function(e,r){var o={groupId:t,success:function(t){e(t)},error:function(e){17==e.type&&r()}};n.WebIM.conn.joinGroup(o)})},agreeJoinGroup:function(e,t){var n=e.state,r={applicant:n.user.username,groupId:t,success:function(e){console.log("申请成功！")},error:function(e){console.log(e)}};n.WebIM.conn.agreeJoinGroup(r)},sendGroupText:function(e,t){var n=e.state,r=e.commit,o=t.gid,a=t.content,s=n.WebIM.conn.getUniqueId(),c=new n.WebIM.message("txt",s),i={msg:a,to:o,roomType:!1,ext:{},success:function(){console.log("send room text success"),r("addGRoupMsg",{id:s,data:a,from:n.user.username,to:o})},fail:function(){console.log("failed")}};c.set(i),c.setGroup("groupchat"),n.WebIM.conn.send(c.body)}}}),z=(n("d7e5"),n("28da")),q=(n("b846"),n("a071")),H=(n("b6e5"),n("55f1")),K=(n("0ece"),n("27fd")),V=(n("8b88"),n("681b")),Q=(n("a71a"),n("b558")),X=(n("20c5"),n("bb76")),Y=(n("c721"),n("3af3")),Z=(n("380f"),n("f64c")),ee=(n("805a"),n("0c63")),te=(n("e1f5"),n("5efb")),ne=[te["a"],ee["a"],Z["a"],y["a"],Y["a"],X["a"],Q["a"],V["a"],K["a"],H["a"],q["a"],z["a"]],re={install:function(e){ne.forEach(function(t){return e.use(t)})}},oe=n("e1f8"),ae=n.n(oe),se={xmppURL:"im-api.easemob.com",apiURL:("https:"===location.protocol?"https:":"http:")+"//a1.easemob.com",appkey:"1110190816148595#wechat-demo",https:!1,isHttpDNS:!0,isMultiLoginSessions:!1,isAutoLogin:!0,isDebug:!1,autoReconnectNumMax:2,autoReconnectInterval:2,sWebRTC:(/Firefox/.test(navigator.userAgent)||/WebKit/.test(navigator.userAgent))&&/^https\:$/.test(window.location.protocol),heartBeatWait:4500,msgStatus:!0,delivery:!0,read:!1,encrypt:{type:"none"}},ce=se,ie=window.WebIM||{};ie.config=ce,ie.conn=new ae.a.connection({isHttpDNS:ie.config.isHttpDNS,isMultiLoginSessions:ie.config.isMultiLoginSessions,https:ie.config.https,url:ie.config.xmppURL,isAutoLogin:!0,heartBeatWait:ie.config.heartBeatWait,autoReconnectNumMax:ie.config.autoReconnectNumMax,autoReconnectInterval:ie.config.autoReconnectInterval,isStropheLog:ie.config.isStropheLog,delivery:ie.config.delivery,appKey:ie.config.appkey});var ue=ie,le=ue;r["a"].use(re),r["a"].config.productionTip=!1,$.beforeEach(function(e,t,n){J.state.loginStatus?n():"/login"===e.path?n():"/register"===e.path?n():$.replace("/login")}),new r["a"]({router:$,store:J,render:function(e){return e(u)}}).$mount("#app"),J.dispatch("getConnectionAndCreateEventListener",le),$.replace("/")},"58ea":function(e,t,n){},"64a9":function(e,t,n){},"6a3f":function(e,t,n){"use strict";var r=n("3a59"),o=n.n(r);o.a},"81e5":function(e,t,n){},a0cf:function(e,t,n){e.exports=n.p+"img/qq-group.5cbe13d6.jpeg"},c16a:function(e,t,n){"use strict";var r=n("81e5"),o=n.n(r);o.a}});
//# sourceMappingURL=app.bee5d0c8.js.map